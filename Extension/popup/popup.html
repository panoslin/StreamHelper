<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>StreamHelper - M3U8 Requests</title>
  <link rel="stylesheet" href="popup.css">
</head>
<body>
  <!-- Header Section -->
  <header class="header">
    <div class="header-content">
      <div class="logo">
        <svg class="logo-icon" viewBox="0 0 24 24" fill="currentColor">
          <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/>
        </svg>
        <h1 class="title">StreamHelper</h1>
      </div>
      <div class="header-actions">
        <button id="refreshBtn" class="icon-btn" title="Refresh">
          <svg viewBox="0 0 24 24" fill="currentColor">
            <path d="M17.65 4.35A7.958 7.958 0 0012 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08A5.99 5.99 0 0112 18c-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z"/>
          </svg>
        </button>
        <button id="clearBtn" class="icon-btn danger" title="Clear All">
          <svg viewBox="0 0 24 24" fill="currentColor">
            <path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"/>
          </svg>
        </button>
      </div>
    </div>
    <div class="stats">
      <span id="requestCount" class="request-count">0 requests</span>
      <span class="separator">â€¢</span>
      <span id="totalSize" class="total-size">0 B</span>
      <span class="separator">â€¢</span>
      <span class="status" id="status">Ready</span>
      <span class="separator">â€¢</span>
      <span class="connection-status" id="connectionStatus" title="StreamHelper Desktop App Connection">
        <span class="connection-indicator" id="connectionIndicator"></span>
        <span class="connection-text" id="connectionText">Disconnected</span>
        <button id="connectBtn" class="connect-btn" title="Connect to StreamHelper Desktop App">
          <svg viewBox="0 0 24 24" fill="currentColor">
            <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/>
          </svg>
          <span>Connect</span>
        </button>
      </span>
      <span class="separator">â€¢</span>
      <button id="viewModeToggle" class="view-mode-toggle" title="Toggle between current tab and all requests">
        <span id="viewModeText">Current Tab</span>
      </button>
    </div>
  </header>

  <!-- Search and Filter Section -->
  <div class="search-section">
    <div class="search-container">
      <svg class="search-icon" viewBox="0 0 24 24" fill="currentColor">
        <path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/>
      </svg>
      <input 
        type="text" 
        id="searchInput" 
        class="search-input" 
        placeholder="Search requests..."
        autocomplete="off"
      >
      <button id="clearSearchBtn" class="clear-search-btn" title="Clear search">
        <svg viewBox="0 0 24 24" fill="currentColor">
          <path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/>
        </svg>
      </button>
    </div>
  </div>

  <!-- Requests List Section -->
  <div class="requests-section">
    <div id="requestsContainer" class="requests-container">
      <!-- Requests will be dynamically inserted here -->
    </div>
    
    <!-- Empty State -->
    <div id="emptyState" class="empty-state">
      <div class="empty-icon">
        <svg viewBox="0 0 24 24" fill="currentColor">
          <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-5 14H7v-2h7v2zm3-4H7v-2h10v2zm0-4H7V7h10v2z"/>
        </svg>
      </div>
      <h3>No M3U8 Requests Yet</h3>
      <p>Navigate to a page with streaming content to capture requests</p>
    </div>
    
    <!-- Loading State -->
    <div id="loadingState" class="loading-state">
      <div class="spinner"></div>
      <p>Loading requests...</p>
    </div>
  </div>

  <!-- Footer Section -->
  <footer class="footer">
    <div class="footer-content">
      <span class="version">v1.0.0</span>
      <div class="footer-actions">
        <button id="exportBtn" class="text-btn" title="Export requests">
          Export
        </button>
        <button id="settingsBtn" class="text-btn" title="Settings">
          Settings
        </button>
      </div>
    </div>
  </footer>

  <!-- Request Item Template (hidden) -->
  <template id="requestTemplate">
    <div class="request-item" data-id="">
      <div class="request-header">
        <div class="request-info">
          <span class="request-method"></span>
          <span class="request-time"></span>
          <span class="request-size"></span>
        </div>
        <div class="request-actions">
          <button class="copy-btn" title="Copy URL">
            <svg viewBox="0 0 24 24" fill="currentColor">
              <path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"/>
            </svg>
            <span>Copy</span>
          </button>
          <button class="ytdlp-btn" title="Copy yt-dlp command">
            <svg viewBox="0 0 24 24" fill="currentColor">
              <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-7 14h-2v-4H6v-2h4V7h2v4h4v2h-4v4z"/>
            </svg>
            <span>DL</span>
          </button>
          <button class="streamhelper-btn" title="Download to StreamHelper">
            <svg viewBox="0 0 24 24" fill="currentColor">
              <path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/>
            </svg>
            <span>SH</span>
          </button>
          <button class="delete-btn" title="Delete">
            <svg viewBox="0 0 24 24" fill="currentColor">
              <path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"/>
            </svg>
          </button>
        </div>
      </div>
      <div class="request-url-container">
        <div class="request-url"></div>
        <button class="show-full-url-btn" title="Show full URL">ðŸ“‹</button>
      </div>
      <div class="request-context">
        <span class="page-title"></span>
        <span class="page-url"></span>
      </div>
    </div>
  </template>

  <!-- Toast Notification -->
  <div id="toast" class="toast">
    <span id="toastMessage"></span>
  </div>

  <script src="popup.js"></script>
</body>
</html>
